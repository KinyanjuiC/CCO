<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Register - Cloud Computing Optimization</title>
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900%7CQuicksand:400,700%7CQuestrial" rel="stylesheet" />
  <link href="default.css" rel="stylesheet" type="text/css" media="all" />
  <style>
    form {
  max-width: 400px;
  margin: 0 auto;
  padding: 20px;
  border: 1px solid #ccc;
  border-radius: 5px;
  background-color: #f9f9f9;
}

form input, form button {
  width: 100%;
  padding: 10px;
  margin: 5px 0;
  border: 1px solid #ccc;
  border-radius: 3px;
}

  </style>
</head>
<body>
<div id="header-wrapper">
  <div id="header" class="container">
    <div id="logo"><h1><a href="index.html">Cloud Computing Optimization (CCO)</a></h1></div>
    <div id="menu">
      <ul>
        <li><a href="index.html">Homepage</a></li>
        <li><a href="resources.html">Resources</a></li>
        <li><a href="about.html">About Me</a></li>
        <li><a href="contact.html">Contact Me</a></li>
        <li><a href="login.html">Login</a></li>
        <li class="active"><a href="register.html">Register</a></li>
      </ul>
    </div>
  </div>
</div>

<div class="wrapper">
  <div class="container">
    <div class="title" style="text-align: center;"><h2>Register</h2></div>
    <form action="/register" method="post">
      <label for="name">Name:</label><br>
      <input type="text" id="name" name="name" required><br><br>
      
      <label for="email">Email:</label><br>
      <input type="email" id="email" name="email" required><br><br>
      
      <label for="password">Password:</label><br>
      <input type="password" id="password" name="password" required><br><br>

      <label for="role">Role:</label><br>
      <select id="role" name="role">
        <option value="user">User</option>
        <option value="admin">Admin</option>
      </select><br><br>

      <button type="submit">Register</button>
    </form>
  </div>
  </div>
</div>

<div id="footer">
  <div class="container">
    <div class="fbox1">
      <span class="icon icon-map-marker"></span>
      <span>1234 Cloud Campus, Nairobi, Kenya</span>
    </div>
    <div class="fbox1">
      <span class="icon icon-phone"></span>
      <span>Telephone: +254 723 100 967</span>
    </div>
    <div class="fbox1">
      <span class="icon icon-envelope"></span>
      <span>collinskimani6@gmail.com</span>
    </div>
  </div>
</div>

<script>
  const BASE_URL = "https://cloud-computing-optimization-apt3065proj.onrender.com";

  document.getElementById('registerForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    const role = document.getElementById('role').value;

    // Validate password length
    if (password.length < 8) {
      document.getElementById('registrationStatus').innerText = 'Password must be at least 8 characters long.';
      return;
    }

    try {
      const response = await fetch(`${BASE_URL}/auth/register`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, email, password, role}),
      });

      const result = await response.json();

      if (response.ok) {
        document.getElementById('registrationStatus').innerText = 'Registration successful!';
        window.location.href = 'login.html'; // Redirect to login page
      } else {
        document.getElementById('registrationStatus').innerText = result.error || 'Registration failed.';
      }
    } catch (error) {
      console.error(error);
      document.getElementById('registrationStatus').innerText = 'An error occurred. Please try again.';
    }
  });
</script>

<script>
  const BASE_URL = "https://cloud-computing-optimization-apt3065proj.onrender.com";
  document.getElementById('registerForm').addEventListener('submit', (e) => {
    const password = document.getElementById('password').value;

    if (password.length < 8) {
      e.preventDefault();
      document.getElementById('registrationStatus').innerText = 'Password must be at least 8 characters long.';
    }
  });
</script>
</body>
</html>


